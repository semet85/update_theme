<div role="main" class="hero">
  <div class="container">
    <div class="row row1">
      <div class="col-md-12">
        {% block search %}
          {% snippet 'home/snippets/search.html' %}
        {% endblock %}
      </div>
    </div>
  </div>
</div>

<div class="main">
  <div class="container">
    <div class="row row2">
      <div class="col-md-12">
        {% block stats %}
          {% snippet 'home/snippets/stats.html' %}
        {% endblock %}
      </div>
    </div>  
  </div>
</div>

<div class="main">
  <div class="container">
    <h2 class="text-center mb-4"> <i class="fas fa-building"></i> Kategori & Organisasi </h2>
    <div class="row row3">
      <div class="col-md-6 col1">
        {% block featured_group %}
          {% snippet 'home/snippets/featured_group.html' %}
        {% endblock %}
      </div>
      <div class="col-md-6 col2">
        {% block featured_organization %}
          {% snippet 'home/snippets/featured_organization.html' %}
        {% endblock %}
      </div>
    </div>
  </div>
</div>

<!-- TOPIK DATA CAROUSEL -->
<div class="main">
  <div class="container">
    <div class="row row4">
      <div class="col-md-12">
        {% block group_list %}
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
        <h2 class="text-center mb-4"> <i class="fas fa-folder-open"></i> Topik Data</h2>
        ...
        {% endblock %}
      </div>
    </div>
  </div>
</div>

<!-- STATISTIK WEBSITE -->
<div class="main">
  <div class="container">
    <div class="row mt-5">
      <div class="col-12">
        <h2 class="text-center mb-4">
          <i class="fas fa-chart-line"></i> Statistik Website
        </h2>

        <!-- Center wrapper -->
        <div class="stats-wrapper2">
          <div class="stats-grid2">
            
            <!-- Total Pengunjung -->
            <div class="stat-card2 text-center">
              <i class="fas fa-user-friends"></i>
              <h3 class="stat-number2" id="totalUsers">0</h3>
              <p class="stat-label2">Total Pengunjung</p>
            </div>

            <!-- Total Pageviews -->
            <div class="stat-card2 text-center">
              <i class="fas fa-file-alt"></i>
              <h3 class="stat-number2" id="totalPageviews">0</h3>
              <p class="stat-label2">Total Pageviews</p>
            </div>

            <!-- Pengunjung Hari Ini -->
            <div class="stat-card2 text-center">
              <i class="fas fa-calendar-day"></i>
              <h3 class="stat-number2" id="todayUsers">0</h3>
              <p class="stat-label2">Pengunjung Hari Ini</p>
            </div>

          </div>
        </div>
        <!-- End Center wrapper -->

      </div>
    </div>
  </div>
</div>

<!-- STYLE -->
<style>
/* ... (style carousel + statistik tetap sama seperti yang kamu tulis) ... */
</style>

<!-- SCRIPT -->
<script src="https://apis.google.com/js/api.js"></script>
<script>
  const CLIENT_ID = "353945050996-nir7fb92pasbcuqni7dvq8mlfdtfnufr.apps.googleusercontent.com"; // dari Google Cloud Console
  const PROPERTY_ID = "502268477"; // angka dari GA4 property

  function initClient() {
    gapi.client.init({
      clientId: CLIENT_ID,
      scope: "https://www.googleapis.com/auth/analytics.readonly",
    }).then(() => {
      if (!gapi.auth2.getAuthInstance().isSignedIn.get()) {
        gapi.auth2.getAuthInstance().signIn();
      }
      loadAnalytics();
    });
  }

  function loadAnalytics() {
    gapi.client.load("analyticsdata", "v1").then(() => {
      queryReport();
    });
  }

  function queryReport() {
    gapi.client.analyticsdata.properties.runReport({
      property: "properties/" + PROPERTY_ID,
      requestBody: {
        dateRanges: [{ startDate: "7daysAgo", endDate: "today" }],
        metrics: [
          { name: "activeUsers" },
          { name: "screenPageViews" }
        ]
      }
    }).then(response => {
      let rows = response.result.rows[0].metricValues;
      document.getElementById("totalUsers").innerText = rows[0].value;
      document.getElementById("totalPageviews").innerText = rows[1].value;
    });

    // Hari ini khusus
    gapi.client.analyticsdata.properties.runReport({
      property: "properties/" + PROPERTY_ID,
      requestBody: {
        dateRanges: [{ startDate: "today", endDate: "today" }],
        metrics: [{ name: "activeUsers" }]
      }
    }).then(response => {
      let today = response.result.rows[0].metricValues[0].value;
      document.getElementById("todayUsers").innerText = today;
    });
  }

  gapi.load("client:auth2", initClient);
</script>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-LGD3KZ8K7Q"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-LGD3KZ8K7Q');
</script>
