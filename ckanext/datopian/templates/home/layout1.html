<div role="main" class="hero">
  <div class="container">
    <div class="row row1">
      <div class="col-md-12">
        {% block search %}
          {% snippet 'home/snippets/search.html' %}
        {% endblock %}
      </div>
    </div>
  </div>
</div>

<div class="main">
  <div class="container">
    <div class="row row2">
      <div class="col-md-12">
        {% block stats %}
          {% snippet 'home/snippets/stats.html' %}
        {% endblock %}
      </div>
    </div>  
  </div>
</div>

<div class="main">
  <div class="container">
    <h2 class="text-center mb-4"> <i class="fas fa-building"></i> Kategori & Organisasi </h2>
    <div class="row row3">
      <div class="col-md-6 col1">
        {% block featured_group %}
          {% snippet 'home/snippets/featured_group.html' %}
        {% endblock %}
      </div>
      <div class="col-md-6 col2">
        {% block featured_organization %}
          {% snippet 'home/snippets/featured_organization.html' %}
        {% endblock %}
      </div>
    </div>
  </div>
</div>

<div class="main">
  <div class="container">
    <div class="row row4">
      <div class="col-md-12">
        {% block group_list %}
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
        <h2 class="text-center mb-8 text-2xl font-semibold">
          <i class="fas fa-folder-open"></i> Topik Data
        </h2>

        {% set groups = h.get_featured_groups(count=10) %}
        {% if not groups %}
          <p class="text-center">{{ _('Tidak ada kategori yang ditemukan.') }}</p>
        {% else %}
        <div class="relative">
          <!-- Tombol navigasi kiri -->
          <button class="absolute left-0 top-1/2 transform -translate-y-1/2 bg-white dark:bg-gray-700 text-gray-800 dark:text-white p-2 rounded-full shadow z-10 left-btn">
            &#10094;
          </button>

          <!-- Tombol navigasi kanan -->
          <button class="absolute right-0 top-1/2 transform -translate-y-1/2 bg-white dark:bg-gray-700 text-gray-800 dark:text-white p-2 rounded-full shadow z-10 right-btn">
            &#10095;
          </button>

          <div class="overflow-x-hidden">
            <div class="carousel-track flex gap-4 transition-transform duration-300">
              {% for group in groups %}
              <div class="flex-none w-72">
                <div class="rounded-xl border bg-white shadow hover:shadow-lg overflow-hidden transition-shadow duration-300 dark:bg-gray-800">
                  <a href="{{ h.url_for(controller='group', action='read', id=group.name) }}">
                    <div class="p-4 space-y-4">
                      <div class="flex items-center gap-3">
                        <span class="flex-shrink-0 h-12 w-12 rounded-full overflow-hidden">
                          <img class="h-full w-full object-cover" src="{{ group.image_display_url or h.url_for_static('/base/images/placeholder-group.png') }}" alt="{{ group.title }}">
                        </span>
                        <span class="line-clamp-2 font-medium text-lg">{{ group.title }}</span>
                      </div>
                    </div>
                    <img class="w-full h-48 object-cover" src="{{ group.image_display_url or h.url_for_static('/base/images/placeholder-group.png') }}" alt="{{ group.title }}">
                  </a>
                </div>
              </div>
              {% endfor %}
            </div>
          </div>
        </div>
        {% endif %}
        {% endblock %}
      </div>
    </div>
  </div>
</div>

<div class="main">
  <div class="container">
    <div class="row mt-5">
      <div class="col-12">
        <h2 class="text-center mb-4">
          <i class="fas fa-chart-line"></i> Statistik Website
        </h2>

        <div class="stats-wrapper2">
          <div class="stats-grid2">
            <div class="stat-card2 text-center">
              <i class="fas fa-user-friends"></i>
              <h3 class="stat-number2" data-target="12345">0</h3>
              <p class="stat-label2">Total Pengunjung</p>
            </div>
            <div class="stat-card2 text-center">
              <i class="fas fa-file-alt"></i>
              <h3 class="stat-number2" data-target="67890">0</h3>
              <p class="stat-label2">Total Pageviews</p>
            </div>
            <div class="stat-card2 text-center">
              <i class="fas fa-calendar-day"></i>
              <h3 class="stat-number2" data-target="123">0</h3>
              <p class="stat-label2">Pengunjung Hari Ini</p>
            </div>
          </div>
        </div>

      </div>
    </div>
  </div>
</div>

<style>
/* Carousel Group */
.carousel-track { display: flex; gap: 16px; transition: transform 0.3s; }
.flex-none { flex: 0 0 auto; }
.rounded-xl { border-radius: 12px; }
.shadow { box-shadow: 0 2px 6px rgba(0,0,0,0.15); }
.shadow:hover { transform: translateY(-5px); }

/* Tombol navigasi */
.left-btn, .right-btn { cursor: pointer; font-size: 20px; }

/* Statistik Website */
.stats-wrapper2 { display: flex; justify-content: center; margin-top: 20px; }
.stats-grid2 { display: flex; flex-wrap: wrap; gap: 25px; justify-content: center; max-width: 900px; }
.stat-card2 { background: linear-gradient(135deg,#3498db,#2980b9); color: #fff; padding:30px 20px; border-radius:15px; width:220px; height:200px; display:flex; flex-direction:column; justify-content:center; align-items:center; transition:0.3s; box-shadow:0 6px 12px rgba(0,0,0,0.15);}
.stat-card2:hover { transform: translateY(-8px); box-shadow:0 12px 20px rgba(0,0,0,0.25);}
.stat-card2 i { font-size:42px; margin-bottom:15px; }
.stat-number2 { font-size:1.8rem; font-weight:bold; }
.stat-label2 { font-size:1.2rem; margin-top:5px; font-weight:500; }
/* Responsive */
@media (max-width:992px) { .stat-card2 { width:45%; height:180px; } }
@media (max-width:576px) { .stat-card2 { width:100%; height:auto; padding:20px; } }
</style>

<script>
/* Carousel Script */
document.addEventListener("DOMContentLoaded", function(){
  const track = document.querySelector(".carousel-track");
  const leftBtn = document.querySelector(".left-btn");
  const rightBtn = document.querySelector(".right-btn");
  const cardWidth = track.querySelector('.flex-none').offsetWidth + 16;

  let position = 0;

  rightBtn.addEventListener("click", () => {
    const maxScroll = -(track.scrollWidth - track.parentElement.offsetWidth);
    position -= cardWidth;
    if(position < maxScroll) position = maxScroll;
    track.style.transform = `translateX(${position}px)`;
  });

  leftBtn.addEventListener("click", () => {
    position += cardWidth;
    if(position > 0) position = 0;
    track.style.transform = `translateX(${position}px)`;
  });

  /* Statistik CountUp */
  const counters = document.querySelectorAll(".stat-number2");
  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if(entry.isIntersecting && !entry.target.classList.contains("counted")) {
        const target = +entry.target.getAttribute("data-target");
        let start = 0;
        const stepTime = Math.abs(Math.floor(1500 / target));
        const timer = setInterval(()=>{
          start++;
          entry.target.textContent = start.toLocaleString();
          if(start>=target) clearInterval(timer);
        }, stepTime);
        entry.target.classList.add("counted");
      }
    });
  }, { threshold: 0.5 });
  counters.forEach(counter => observer.observe(counter));
});
</script>
